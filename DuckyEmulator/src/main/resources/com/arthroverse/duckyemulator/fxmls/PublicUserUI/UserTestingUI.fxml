<?xml version="1.0" encoding="UTF-8"?>

<!--
  ~ Copyright (c) 2025 Arthroverse Laboratory
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  ~
  ~ Organization: Arthroverse Laboratory
  ~ Author: Vinh Dinh Mai
  ~ Contact: business@arthroverse.com
  ~
  ~ Test Session UI - User Testing Interface
  ~ Features: Question Navigator, Stopwatch, Question Display, Answer Selection
  ~
  ~ @author ducksabervn
  -->

<?import io.github.palexdev.materialfx.controls.MFXButton?>
<?import io.github.palexdev.materialfx.controls.MFXRadioButton?>
<?import io.github.palexdev.materialfx.controls.MFXScrollPane?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.Separator?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.text.Font?>

<BorderPane stylesheets="@../../css/UserTestingPage.css" xmlns="http://javafx.com/javafx/18" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.arthroverse.duckyemulator.UIControllers.PublicUIController.UserTestingUIController">
    <top>
        <!-- Header Section with Stopwatch -->
        <VBox style="-fx-background-color: linear-gradient(to right, #332D7B, #42A5F5); -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.2), 4, 0, 0, 2);">
            <children>
                <HBox alignment="CENTER_LEFT" spacing="20.0">
                    <children>
                        <Label styleClass="user_welcome_message" text="DuckyEmulator" textFill="WHITE">
                            <font>
                                <Font name="Segoe UI" size="24.0" />
                            </font>
                        </Label>
                        <Label styleClass="user_welcome_sub_message" text="Test Session" textFill="#E3F2FD">
                            <font>
                                <Font name="Segoe UI Light" size="18.0" />
                            </font>
                        </Label>
                        <Region HBox.hgrow="ALWAYS" />
                        <!-- Stopwatch Label -->
                        <Label fx:id="labelElapsedTime" styleClass="user_welcome_sub_message" text="Time Remaining: 00:00:00" textFill="WHITE">
                            <font>
                                <Font name="Segoe UI Semibold" size="18.0" />
                            </font>
                        </Label>
                    </children>
                    <padding>
                        <Insets bottom="15.0" left="30.0" right="30.0" top="15.0" />
                    </padding>
                </HBox>
            </children>
        </VBox>
    </top>

    <left>
        <!-- Question Navigator -->
        <VBox prefWidth="300.0" style="-fx-background-color: #fafafa; -fx-border-color: #e0e0e0; -fx-border-width: 0 1 0 0;">
            <children>
                <!-- Navigator Header -->
                <VBox spacing="10.0">
                    <children>
                        <Label styleClass="other_text" text="Question Navigator" textFill="#202124">
                            <font>
                                <Font name="Segoe UI Semibold" size="16.0" />
                            </font>
                        </Label>
                        <Label styleClass="welcome_label_subtext" text="Click on any question to jump to it" textFill="#5f6368">
                            <font>
                                <Font name="Segoe UI" size="12.0" />
                            </font>
                        </Label>
                    </children>
                    <padding>
                        <Insets bottom="10.0" left="20.0" right="20.0" top="20.0" />
                    </padding>
                </VBox>

                <Separator>
                    <VBox.margin>
                        <Insets left="10.0" right="10.0" />
                    </VBox.margin>
                </Separator>

                <!-- Question Navigator Table -->
                <TableView fx:id="tableViewQuestNav" onMouseClicked="#tableViewQuestNav" prefHeight="400.0" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="tableColQuestNum" prefWidth="100.0" text="Question #">
                        </TableColumn>
                        <TableColumn fx:id="tableColQuestStatus" prefWidth="120.0" text="Status">
                        </TableColumn>
                    </columns>
                    <VBox.margin>
                        <Insets bottom="20.0" left="15.0" right="15.0" top="10.0" />
                    </VBox.margin>
                </TableView>

                <!-- Quick Actions -->
                <VBox spacing="8.0">
                    <children>
                        <Separator>
                            <VBox.margin>
                                <Insets left="10.0" right="10.0" />
                            </VBox.margin>
                        </Separator>

                        <MFXButton mnemonicParsing="false" onAction="#btnSubmitTest" prefHeight="40.0" prefWidth="260.0" style="-fx-background-color: #ff5722; -fx-background-radius: 20; -fx-text-fill: white; -fx-cursor: hand;" styleClass="mfx-button" text="🏁  Submit Test">
                            <font>
                                <Font name="Segoe UI Semibold" size="14.0" />
                            </font>
                        </MFXButton>
                    </children>
                    <padding>
                        <Insets bottom="20.0" left="20.0" right="20.0" top="10.0" />
                    </padding>
                </VBox>
            </children>
        </VBox>
    </left>

    <center>
        <!-- Main Question Display Area -->
        <VBox style="-fx-background-color: #f8f9fa;">
            <children>
                <!-- Question Content Area -->
                <HBox spacing="15.0" VBox.vgrow="ALWAYS">
                    <children>
                        <!-- Left Side: Question Statement + Image -->
                        <VBox spacing="15.0" HBox.hgrow="ALWAYS">
                            <children>
                                <!-- Question Statement Card -->
                                <StackPane>
                                    <children>
                                        <!-- Card Background -->
                                        <Pane style="-fx-background-color: white; -fx-background-radius: 12; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 8, 0, 0, 2);" />

                                        <!-- Question Content -->
                                        <VBox spacing="15.0">
                                            <children>
                                                <!-- Question Header -->
                                                <HBox alignment="CENTER_LEFT" spacing="12.0">
                                                    <children>
                                                        <Label fx:id="labelCurrentQuestion" styleClass="other_text_bold" text="Question 1" textFill="#332D7B">
                                                            <font>
                                                                <Font name="Segoe UI Semibold" size="20.0" />
                                                            </font>
                                                        </Label>
                                                        <Region HBox.hgrow="ALWAYS" />
                                                        <Label fx:id="labelSecondaryQuestCounter" styleClass="other_text_bold" text="1 of 50" textFill="#5f6368">
                                                            <font>
                                                                <Font name="Segoe UI" size="14.0" />
                                                            </font>
                                                        </Label>
                                                    </children>
                                                </HBox>

                                                <Separator />

                                                <!-- Question Statement -->
                                                <MFXScrollPane fitToWidth="true" prefHeight="259.0" prefWidth="1542.0">
                                                    <content>
                                                        <Label fx:id="labelQuestionStatement" styleClass="other_text" text="This is a sample question statement. Please read the question carefully and select the most appropriate answer from the options provided below. The question may include multiple parts or require analysis of the accompanying image." textFill="#202124" wrapText="true">
                                                            <font>
                                                                <Font name="Segoe UI" size="16.0" />
                                                            </font>
                                                        </Label>
                                                    </content>
                                                </MFXScrollPane>
                                            </children>
                                            <padding>
                                                <Insets bottom="15.0" left="25.0" right="25.0" top="15.0" />
                                            </padding>
                                        </VBox>
                                    </children>
                                </StackPane>

                                <!-- Question Image Card -->
                                <StackPane>
                                    <children>
                                        <!-- Card Background -->
                                        <Pane style="-fx-background-color: white; -fx-background-radius: 12; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 8, 0, 0, 2);" />

                                        <!-- Image Content -->
                                        <VBox spacing="10.0">
                                            <children>
                                                <Label styleClass="other_text_bold" text="Question Image" textFill="#332D7B">
                                                    <font>
                                                        <Font name="Segoe UI Semibold" size="16.0" />
                                                    </font>
                                                </Label>

                                                <!-- Image Placeholder -->
                                                <StackPane prefHeight="150.0" style="-fx-background-color: #f5f5f5; -fx-background-radius: 8; -fx-border-color: #e0e0e0; -fx-border-radius: 8; -fx-border-width: 1;">
                                                    <children>
                                                        <VBox alignment="CENTER" prefHeight="173.0" prefWidth="1540.0" spacing="10.0">
                                                            <children>
                                                                <Label text="🖼️" textFill="#9e9e9e">
                                                                    <font>
                                                                        <Font size="48.0" />
                                                                    </font>
                                                                </Label>
                                                                <Label styleClass="other_text" text="No image !" textFill="#9e9e9e">
                                                                    <font>
                                                                        <Font name="Segoe UI" size="14.0" />
                                                                    </font>
                                                                </Label>
                                                            </children>
                                                        </VBox>
                                                        <!-- Actual ImageView for real implementation -->
                                                        <ImageView fx:id="imageViewQuestImg" fitHeight="199.0" fitWidth="250.0" pickOnBounds="true" preserveRatio="true" visible="false">
                                                        </ImageView>
                                                    </children>
                                                </StackPane>
                                            </children>
                                            <padding>
                                                <Insets bottom="15.0" left="25.0" right="25.0" top="15.0" />
                                            </padding>
                                        </VBox>
                                    </children>
                                </StackPane>
                            </children>
                        </VBox>

                        <!-- Right Side: Answer Options -->
                        <VBox spacing="15.0" HBox.hgrow="ALWAYS">
                            <children>
                                <!-- Answers Card -->
                                <StackPane VBox.vgrow="ALWAYS">
                                    <children>
                                        <!-- Card Background -->
                                        <Pane style="-fx-background-color: white; -fx-background-radius: 12; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 8, 0, 0, 2);" />

                                        <!-- Answer Content -->
                                        <VBox spacing="20.0">
                                            <children>
                                                <!-- Answer Header -->
                                                <HBox alignment="CENTER_LEFT" spacing="10.0">
                                                    <children>
                                                        <Label text="✅" textFill="#4caf50">
                                                            <font>
                                                                <Font size="24.0" />
                                                            </font>
                                                        </Label>
                                                        <Label styleClass="other_text" text="Select Your Answer" textFill="#202124">
                                                            <font>
                                                                <Font name="Segoe UI Semibold" size="18.0" />
                                                            </font>
                                                        </Label>
                                                    </children>
                                                </HBox>

                                                <Separator />

                                                <!-- Answer Options -->
                                                <VBox spacing="15.0">
                                                    <children>
                                                        <!-- Answer A -->
                                                        <MFXRadioButton fx:id="mfxRadBtnFirst" styleClass="mfx-radio-button" text="A. First answer option - this could be a longer text that wraps to multiple lines if needed" wrapText="true">
                                                            <toggleGroup>
                                                            </toggleGroup>
                                                        </MFXRadioButton>

                                                        <!-- Answer B -->
                                                        <MFXRadioButton fx:id="mfxRadBtnSecond" styleClass="mfx-radio-button" text="B. Second answer option - each answer can contain different types of content and varying lengths" wrapText="true">
                                                            <toggleGroup>
                                                            </toggleGroup>
                                                        </MFXRadioButton>

                                                        <!-- Answer C -->
                                                        <MFXRadioButton fx:id="mfxRadBtnThird" styleClass="mfx-radio-button" text="C. Third answer option - students can select only one option from the available choices" wrapText="true">
                                                            <toggleGroup>
                                                            </toggleGroup>
                                                        </MFXRadioButton>

                                                        <!-- Answer D -->
                                                        <MFXRadioButton fx:id="mfxRadBtnFourth" styleClass="mfx-radio-button" text="D. Fourth answer option - this completes the set of four possible answers for this question" wrapText="true">
                                                            <toggleGroup>
                                                            </toggleGroup>
                                                        </MFXRadioButton>
                                                    </children>
                                                </VBox>
                                            </children>
                                            <padding>
                                                <Insets bottom="20.0" left="25.0" right="25.0" top="20.0" />
                                            </padding>
                                        </VBox>
                                    </children>
                                </StackPane>
                            </children>
                        </VBox>
                    </children>
                    <VBox.margin>
                        <Insets bottom="15.0" left="30.0" right="30.0" top="15.0" />
                    </VBox.margin>
                </HBox>
            </children>
        </VBox>
    </center>

    <bottom>
        <!-- Navigation Controls -->
        <VBox style="-fx-background-color: white; -fx-border-color: #e0e0e0; -fx-border-width: 1 0 0 0;">
            <children>
                <HBox alignment="CENTER" spacing="30.0">
                    <children>
                        <!-- Previous Button -->
                        <MFXButton mnemonicParsing="false" onAction="#btnPreviousQuestion" prefHeight="50.0" prefWidth="150.0" style="-fx-background-color: transparent; -fx-background-radius: 25; -fx-border-color: linear-gradient(to right, #332D7B, #42A5F5); -fx-border-width: 2; -fx-border-radius: 25; -fx-text-fill: #332D7B; -fx-cursor: hand;" styleClass="mfx-button" text="⬅️  Previous">
                            <font>
                                <Font name="Segoe UI Semibold" size="16.0" />
                            </font>
                        </MFXButton>

                        <!-- Question Info -->
                        <VBox alignment="CENTER" spacing="5.0">
                            <children>
                                <Label fx:id="labelPrimaryQuestCounter" styleClass="other_text_bold" text="Question 1 of 50" textFill="#202124">
                                    <font>
                                        <Font name="Segoe UI Semibold" size="16.0" />
                                    </font>
                                </Label>
                            </children>
                        </VBox>

                        <!-- Next Button -->
                        <MFXButton mnemonicParsing="false" onAction="#btnNextQuestion" prefHeight="50.0" prefWidth="150.0" style="-fx-background-color: linear-gradient(to right, #332D7B, #42A5F5); -fx-background-radius: 25; -fx-text-fill: white; -fx-cursor: hand;" styleClass="mfx-button" text="Next  ➡️">
                            <font>
                                <Font name="Segoe UI Semibold" size="16.0" />
                            </font>
                        </MFXButton>
                    </children>
                </HBox>
            </children>
            <padding>
                <Insets bottom="20.0" left="30.0" right="30.0" top="20.0" />
            </padding>
        </VBox>
    </bottom>
</BorderPane>
